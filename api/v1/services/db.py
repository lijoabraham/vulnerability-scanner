from sqlalchemy.orm import Session
from database.models.users import User
from api.v1.models.user import CreateUser
from api.v1.models.scan import ScanItem
from database.models.scans import Scan


def create_user(db:Session, user:CreateUser):
    db_user = User(email=user.email, hashed_password=user.hashed_password.encode('utf-8'), full_name=user.full_name, is_active=user.is_active)
    db.add(db_user)
    db.commit()
    db.refresh(db_user)
    return db_user

def create_scan(db:Session, scan_data: ScanItem):
    db_scan = Scan(name=scan_data.name, info=scan_data.url, status=1)
    db.add(db_scan)
    db.commit()
    db.refresh(db_scan)
    return db_scan